# 콘서트 예약 서비스

## 📌 프로젝트 개요

콘서트 좌석 예약과 결제 기능 제공하는 대기열 기반 서비스   
동시 다수의 사용자 접속 환경, 서버 인스턴스 확장 대응    
임시 좌석 배정, 결제 처리, 잔액 충전 등 콘서트 티켓 예매 기능 제공
  
---  

## 🗂️ 문서 구조

- [시나리오 및 요구사항 분석](#시나리오-및-요구사항-분석)
- [ERD (데이터베이스 설계)](#erd-데이터베이스-설계)
- [시퀀스 다이어그램](#시퀀스-다이어그램)
- [인프라 구성도 및 구성요소 설명](#인프라-구성도-및-구성요소-설명)

---  

## 시나리오 및 요구사항 분석

1. 유저가 대기열 토큰을 발급받아, 순서가 오면 서비스 이용 가능
2. 예약할 수 있는 날짜 / 좌석 조회
3. 원하는 날짜 / 좌석 예약 요청 ( 좌석은 임시로 5분간 배정 )
4. 잔액 충전( 또는 미리 충전 )
5. 결제 요청( 5분 내 결제, 미결제 시 임시 배정 해제 )
6. 결제 완료 시 좌석 소유권 확정, 대기열 토큰 만료

---  

## ERD (데이터베이스 설계)

- [ERD 자세히 보기](./docs/ERD.png)

> User, Concert, ConcertDate, Seat, QueueToken, Reservation, Payment
- **User**
  - 서비스 사용자(회원) 정보와 잔액 저장

- **QueueToken**
  - 사용자의 대기열 진입 상태와 대기 순번, 토큰 정보 관리

- **Concert**
  - 콘서트(공연)의 기본 정보 관리

- **ConcertDate**
  - 각 콘서트의 실제 공연 날짜와 시간 정보 관리

- **Reservation**
  - 사용자가 특정 날짜와 좌석에 대해 예약(임시 배정 포함)한 내역 기록

- **Seat**
  - 공연 날짜별 좌석 정보와 상태(임시 배정, 확정 등) 저장

- **Payment**
  - 좌석 예약(Reservation)에 대한 결제 내역과 결제 상태 저장

- **Order**
  - 여러 좌석을 한 번에 결제/주문할 수 있도록 묶는 주문 단위

- **OrderItem**
  - 주문 내 각각의 좌석(표) 상세 내역 관리

---  

## 시퀀스 다이어그램

- [시퀀스 다이어그램 상세 보기](./docs/sequence_diagram.png)

> 대기열 토큰 발급, 예약/좌석 임시배정, 결제 등 전체 플로우
---  

## 인프라 구성도 및 구성요소 설명

- [인프라 구성도 및 설명 보기](./docs/infra.png)

### 🗺️ 인프라 구성도
| 구성요소                          | 설명                                       |     |
| ----------------------------- | ---------------------------------------- | --- |
| User (Client)                 | 서비스 사용자                                  |     |
| API Gateway / Load Balancer   | 클라이언트 요청을 여러 App Server에 분산              |     |
| App Server                    | 서비스의 핵심 비즈니스 로직(API, 예약, 결제 등)을 처리       |     |
| DB Primary / DB Replica       | 회원, 예매, 결제 등 영구 데이터 저장/관리. Write/Read 분리 |     |
| Redis                         | 대기열, 좌석 임시배정 등 임시/캐시 데이터 관리              |     |
| Background Worker / Scheduler | 임시 예약 만료 등 비동기/주기적(스케줄) 작업 처리            |     |
